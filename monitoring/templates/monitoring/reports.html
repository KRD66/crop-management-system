{% extends 'monitoring/base.html' %}

{% block title %}Reports - HarvestPro{% endblock %}

{% block page_title %}Reports{% endblock %}

{% block content %}
<style>
/* Reports specific styles */
.reports-metrics {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.report-section {
    background: white;
    border-radius: 12px;
    padding: 24px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    border: 1px solid #f1f5f9;
    margin-bottom: 24px;
}

.report-section h3 {
    color: #1e293b;
    font-size: 1.25rem;
    font-weight: 600;
    margin: 0 0 8px 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.report-section p {
    color: #64748b;
    font-size: 0.875rem;
    margin: 0 0 20px 0;
}

.report-templates-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.template-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 20px;
    transition: all 0.2s ease;
    cursor: pointer;
    position: relative;
}

.template-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    border-color: #3b82f6;
}

.template-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
}

.template-title {
    font-weight: 600;
    color: #1e293b;
    font-size: 1.1rem;
    margin-bottom: 4px;
}

.template-description {
    color: #64748b;
    font-size: 0.875rem;
    margin-bottom: 16px;
    line-height: 1.5;
}

.template-meta {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 16px;
}

.template-meta-item {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 0.75rem;
    color: #64748b;
}

.template-frequency {
    background: #f1f5f9;
    color: #475569;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 500;
}

.use-template-btn {
    background: #3b82f6;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    font-size: 0.875rem;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s;
    width: 100%;
}

.use-template-btn:hover {
    background: #2563eb;
}

.form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.form-group label {
    font-weight: 500;
    color: #374151;
    font-size: 0.875rem;
}

.form-group input,
.form-group select {
    padding: 10px 12px;
    border: 1px solid #d1d5db;
    border-radius: 8px;
    font-size: 0.875rem;
    transition: border-color 0.2s;
}

.form-group input:focus,
.form-group select:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.generate-btn {
    background: #1f2937;
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 8px;
    font-size: 0.875rem;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: background-color 0.2s;
    min-width: 140px;
    justify-content: center;
}

.generate-btn:hover {
    background: #111827;
}

.generate-btn:disabled {
    background: #9ca3af;
    cursor: not-allowed;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .reports-metrics {
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
    }
    
    .report-templates-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .form-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .template-card {
        padding: 16px;
    }
    
    .report-section {
        padding: 20px;
        margin-bottom: 20px;
    }
}

@media (max-width: 480px) {
    .reports-metrics {
        grid-template-columns: 1fr;
        gap: 12px;
    }
    
    .metric-card {
        padding: 16px;
    }
    
    .metric-value {
        font-size: 1.8rem;
    }
    
    .template-card {
        padding: 14px;
    }
    
    .report-section {
        padding: 16px;
    }
}
</style>

<!-- Reports Overview Metrics -->
<div class="reports-metrics">
    <div class="metric-card">
        <div class="metric-icon" style="background: #3b82f6;">
            <i class="fas fa-file-alt"></i>
        </div>
        <div class="metric-content">
            <div class="metric-label">Available Reports</div>
            <div class="metric-value">4</div>
            <div class="metric-change">Report templates</div>
        </div>
    </div>
    
    <div class="metric-card">
        <div class="metric-icon" style="background: #10b981;">
            <i class="fas fa-chart-bar"></i>
        </div>
        <div class="metric-content">
            <div class="metric-label">Generated Reports</div>
            <div class="metric-value">4</div>
            <div class="metric-change">Ready for download</div>
        </div>
    </div>
    
    <div class="metric-card">
        <div class="metric-icon" style="background: #f59e0b;">
            <i class="fas fa-calendar"></i>
        </div>
        <div class="metric-content">
            <div class="metric-label">This Month</div>
            <div class="metric-value">12</div>
            <div class="metric-change">Reports generated</div>
        </div>
    </div>
    
    <div class="metric-card">
        <div class="metric-icon" style="background: #8b5cf6;">
            <i class="fas fa-chart-line"></i>
        </div>
        <div class="metric-content">
            <div class="metric-label">Data Coverage</div>
            <div class="metric-value">98%</div>
            <div class="metric-change">Data completeness</div>
        </div>
    </div>
</div>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
    <!-- Generate New Report Section -->
    <div class="report-section">
        <h3>
            <i class="fas fa-plus-circle" style="color: #3b82f6;"></i>
            Generate New Report
        </h3>
        <p>Create custom reports based on your data</p>
        
        <form id="generateReportForm" onsubmit="generateReport(event)">
            <div class="form-group" style="margin-bottom: 20px;">
                <label for="reportType">Report Type</label>
                <select id="reportType" name="report_type" required>
                    <option value="" disabled selected>Select report type</option>
                    <option value="monthly_harvest_summary">Monthly Harvest Summary</option>
                    <option value="yield_performance_report">Yield Performance Report</option>
                    <option value="inventory_status_report">Inventory Status Report</option>
                    <option value="farm_productivity_analysis">Farm Productivity Analysis</option>
                </select>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="fromDate">From Date</label>
                    <input type="date" id="fromDate" name="from_date" required>
                </div>
                <div class="form-group">
                    <label for="toDate">To Date</label>
                    <input type="date" id="toDate" name="to_date" required>
                </div>
            </div>
            
            <div class="form-group" style="margin-bottom: 24px;">
                <label for="exportFormat">Export Format</label>
                <select id="exportFormat" name="export_format" required>
                    <option value="pdf">PDF Document</option>
                    <option value="excel">Excel Spreadsheet</option>
                    <option value="csv">CSV File</option>
                </select>
            </div>
            
            <button type="submit" class="generate-btn">
                <i class="fas fa-file-download"></i>
                Generate Report
            </button>
        </form>
    </div>

    <!-- Report Templates Section -->
    <div class="report-section">
        <h3>
            <i class="fas fa-th-large" style="color: #10b981;"></i>
            Report Templates
        </h3>
        <p>Pre-configured report formats</p>
        
        <div style="display: grid; gap: 16px;">
            <div class="template-card" onclick="useTemplate('monthly_harvest_summary')">
                <div class="template-card-header">
                    <div>
                        <div class="template-title">Monthly Harvest Summary</div>
                        <div class="template-description">Comprehensive overview of monthly harvest activities</div>
                    </div>
                </div>
                <div class="template-meta">
                    <div class="template-meta-item">
                        <i class="fas fa-clock"></i>
                        <span class="template-frequency">monthly</span>
                    </div>
                    <div class="template-meta-item">
                        <i class="fas fa-calendar"></i>
                        <span>Last: 2024-08-01</span>
                    </div>
                </div>
                <button class="use-template-btn" onclick="event.stopPropagation(); useTemplate('monthly_harvest_summary')">
                    Use Template
                </button>
            </div>
            
            <div class="template-card" onclick="useTemplate('yield_performance_report')">
                <div class="template-card-header">
                    <div>
                        <div class="template-title">Yield Performance Report</div>
                        <div class="template-description">Detailed analysis of yield vs expectations</div>
                    </div>
                </div>
                <div class="template-meta">
                    <div class="template-meta-item">
                        <i class="fas fa-clock"></i>
                        <span class="template-frequency">quarterly</span>
                    </div>
                    <div class="template-meta-item">
                        <i class="fas fa-calendar"></i>
                        <span>Last: 2024-07-01</span>
                    </div>
                </div>
                <button class="use-template-btn" onclick="event.stopPropagation(); useTemplate('yield_performance_report')">
                    Use Template
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Additional Report Templates Grid -->
<div class="report-templates-grid">
    <div class="template-card" onclick="useTemplate('inventory_status_report')">
        <div class="template-card-header">
            <div>
                <div class="template-title">Inventory Status Report</div>
                <div class="template-description">Current inventory levels and storage information</div>
            </div>
        </div>
        <div class="template-meta">
            <div class="template-meta-item">
                <i class="fas fa-clock"></i>
                <span class="template-frequency">weekly</span>
            </div>
            <div class="template-meta-item">
                <i class="fas fa-calendar"></i>
                <span>Last: 2024-08-05</span>
            </div>
        </div>
        <button class="use-template-btn" onclick="event.stopPropagation(); useTemplate('inventory_status_report')">
            Use Template
        </button>
    </div>
    
    <div class="template-card" onclick="useTemplate('farm_productivity_analysis')">
        <div class="template-card-header">
            <div>
                <div class="template-title">Farm Productivity Analysis</div>
                <div class="template-description">Productivity metrics across all farms</div>
            </div>
        </div>
        <div class="template-meta">
            <div class="template-meta-item">
                <i class="fas fa-clock"></i>
                <span class="template-frequency">seasonal</span>
            </div>
            <div class="template-meta-item">
                <i class="fas fa-calendar"></i>
                <span>Last: 2024-06-01</span>
            </div>
        </div>
        <button class="use-template-btn" onclick="event.stopPropagation(); useTemplate('farm_productivity_analysis')">
            Use Template
        </button>
    </div>
    
    <div class="template-card" onclick="useTemplate('crop_performance_report')">
        <div class="template-card-header">
            <div>
                <div class="template-title">Crop Performance Report</div>
                <div class="template-description">Analysis of crop yield and quality metrics</div>
            </div>
        </div>
        <div class="template-meta">
            <div class="template-meta-item">
                <i class="fas fa-clock"></i>
                <span class="template-frequency">quarterly</span>
            </div>
            <div class="template-meta-item">
                <i class="fas fa-calendar"></i>
                <span>Last: 2024-07-15</span>
            </div>
        </div>
        <button class="use-template-btn" onclick="event.stopPropagation(); useTemplate('crop_performance_report')">
            Use Template
        </button>
    </div>
    
    <div class="template-card" onclick="useTemplate('financial_summary_report')">
        <div class="template-card-header">
            <div>
                <div class="template-title">Financial Summary Report</div>
                <div class="template-description">Revenue and cost analysis by farm and crop</div>
            </div>
        </div>
        <div class="template-meta">
            <div class="template-meta-item">
                <i class="fas fa-clock"></i>
                <span class="template-frequency">monthly</span>
            </div>
            <div class="template-meta-item">
                <i class="fas fa-calendar"></i>
                <span>Last: 2024-07-31</span>
            </div>
        </div>
        <button class="use-template-btn" onclick="event.stopPropagation(); useTemplate('financial_summary_report')">
            Use Template
        </button>
    </div>
</div>

<!-- Recent Reports Section -->
<div class="report-section">
    <h3>
        <i class="fas fa-history" style="color: #8b5cf6;"></i>
        Recently Generated Reports
    </h3>
    <p>Your latest reports ready for download</p>
    
    <div style="overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse; margin-top: 16px;">
            <thead style="background: #f8fafc; border-bottom: 1px solid #e2e8f0;">
                <tr>
                    <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #374151; font-size: 0.875rem;">Report Name</th>
                    <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #374151; font-size: 0.875rem;">Type</th>
                    <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #374151; font-size: 0.875rem;">Generated</th>
                    <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #374151; font-size: 0.875rem;">Format</th>
                    <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #374151; font-size: 0.875rem;">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr style="border-bottom: 1px solid #f1f5f9;">
                    <td style="padding: 12px 16px; color: #111827; font-weight: 500;">August 2024 Harvest Summary</td>
                    <td style="padding: 12px 16px; color: #6b7280;">Monthly Harvest</td>
                    <td style="padding: 12px 16px; color: #6b7280;">Aug 15, 2024</td>
                    <td style="padding: 12px 16px;">
                        <span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 500;">PDF</span>
                    </td>
                    <td style="padding: 12px 16px;">
                        <div style="display: flex; gap: 8px;">
                            <button onclick="downloadReport('harvest_aug_2024.pdf')" style="background: #f0f9ff; color: #0369a1; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.75rem;" title="Download">
                                <i class="fas fa-download"></i>
                            </button>
                            <button onclick="viewReport('harvest_aug_2024.pdf')" style="background: #f0fdf4; color: #15803d; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.75rem;" title="View">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                <tr style="border-bottom: 1px solid #f1f5f9;">
                    <td style="padding: 12px 16px; color: #111827; font-weight: 500;">Q2 2024 Yield Performance</td>
                    <td style="padding: 12px 16px; color: #6b7280;">Yield Performance</td>
                    <td style="padding: 12px 16px; color: #6b7280;">Jul 31, 2024</td>
                    <td style="padding: 12px 16px;">
                        <span style="background: #dcfce7; color: #166534; padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 500;">Excel</span>
                    </td>
                    <td style="padding: 12px 16px;">
                        <div style="display: flex; gap: 8px;">
                            <button onclick="downloadReport('yield_q2_2024.xlsx')" style="background: #f0f9ff; color: #0369a1; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.75rem;" title="Download">
                                <i class="fas fa-download"></i>
                            </button>
                            <button onclick="viewReport('yield_q2_2024.xlsx')" style="background: #f0fdf4; color: #15803d; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.75rem;" title="View">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                <tr style="border-bottom: 1px solid #f1f5f9;">
                    <td style="padding: 12px 16px; color: #111827; font-weight: 500;">Current Inventory Status</td>
                    <td style="padding: 12px 16px; color: #6b7280;">Inventory Status</td>
                    <td style="padding: 12px 16px; color: #6b7280;">Aug 10, 2024</td>
                    <td style="padding: 12px 16px;">
                        <span style="background: #fef3c7; color: #92400e; padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 500;">CSV</span>
                    </td>
                    <td style="padding: 12px 16px;">
                        <div style="display: flex; gap: 8px;">
                            <button onclick="downloadReport('inventory_aug_2024.csv')" style="background: #f0f9ff; color: #0369a1; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.75rem;" title="Download">
                                <i class="fas fa-download"></i>
                            </button>
                            <button onclick="viewReport('inventory_aug_2024.csv')" style="background: #f0fdf4; color: #15803d; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.75rem;" title="View">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="padding: 12px 16px; color: #111827; font-weight: 500;">Farm Productivity Analysis</td>
                    <td style="padding: 12px 16px; color: #6b7280;">Productivity Analysis</td>
                    <td style="padding: 12px 16px; color: #6b7280;">Jul 15, 2024</td>
                    <td style="padding: 12px 16px;">
                        <span style="background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 500;">PDF</span>
                    </td>
                    <td style="padding: 12px 16px;">
                        <div style="display: flex; gap: 8px;">
                            <button onclick="downloadReport('productivity_jul_2024.pdf')" style="background: #f0f9ff; color: #0369a1; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.75rem;" title="Download">
                                <i class="fas fa-download"></i>
                            </button>
                            <button onclick="viewReport('productivity_jul_2024.pdf')" style="background: #f0fdf4; color: #15803d; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.75rem;" title="View">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Loading Modal -->
<div id="loadingModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
    <div style="background: white; padding: 40px; border-radius: 12px; text-align: center; min-width: 300px;">
        <div style="margin-bottom: 20px;">
            <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: #3b82f6;"></i>
        </div>
        <h3 style="margin: 0 0 8px 0; color: #1e293b;">Generating Report</h3>
        <p style="margin: 0; color: #64748b; font-size: 0.875rem;">Please wait while we prepare your report...</p>
        <div style="width: 100%; height: 4px; background: #f1f5f9; border-radius: 2px; margin-top: 20px; overflow: hidden;">
            <div id="progressBar" style="width: 0%; height: 100%; background: #3b82f6; transition: width 0.3s ease; border-radius: 2px;"></div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
// Report generation functionality
function generateReport(event) {
    event.preventDefault();
    
    const formData = new FormData(event.target);
    const reportType = formData.get('report_type');
    const fromDate = formData.get('from_date');
    const toDate = formData.get('to_date');
    const exportFormat = formData.get('export_format');
    
    if (!reportType || !fromDate || !toDate || !exportFormat) {
        alert('Please fill in all required fields');
        return;
    }
    
    if (new Date(fromDate) > new Date(toDate)) {
        alert('From date must be before to date');
        return;
    }
    
    // Show loading modal
    showLoadingModal();
    
    // Simulate report generation progress
    let progress = 0;
    const progressInterval = setInterval(() => {
        progress += Math.random() * 15;
        if (progress > 90) progress = 90;
        document.getElementById('progressBar').style.width = progress + '%';
    }, 200);
    
    // Simulate API call
    setTimeout(() => {
        clearInterval(progressInterval);
        document.getElementById('progressBar').style.width = '100%';
        
        setTimeout(() => {
            hideLoadingModal();
            
            // Show success message
            alert('Report generated successfully! It will be available for download shortly.');
            
            // Reset form
            event.target.reset();
            
            // In real implementation, you would make an AJAX call to your Django view:
            /*
            fetch('/reports/generate/', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Report generated successfully!');
                    // Refresh the page or update the recent reports table
                    location.reload();
                } else {
                    alert('Error generating report: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error generating report. Please try again.');
            });
            */
        }, 500);
    }, 3000);
}

function useTemplate(templateType) {
    // Auto-fill the form with template data
    const reportTypeSelect = document.getElementById('reportType');
    const exportFormatSelect = document.getElementById('exportFormat');
    const fromDateInput = document.getElementById('fromDate');
    const toDateInput = document.getElementById('toDate');
    
    // Set report type
    reportTypeSelect.value = templateType;
    
    // Set default dates based on template
    const today = new Date();
    const currentMonth = new Date(today.getFullYear(), today.getMonth(), 1);
    const lastMonth = new Date(today.getFullYear(), today.getMonth() - 1, 1);
    
    switch(templateType) {
        case 'monthly_harvest_summary':
            fromDateInput.value = lastMonth.toISOString().split('T')[0];
            toDateInput.value = new Date(today.getFullYear(), today.getMonth(), 0).toISOString().split('T')[0];
            exportFormatSelect.value = 'pdf';
            break;
        case 'yield_performance_report':
            fromDateInput.value = new Date(today.getFullYear(), today.getMonth() - 3, 1).toISOString().split('T')[0];
            toDateInput.value = today.toISOString().split('T')[0];
            exportFormatSelect.value = 'excel';
            break;
        case 'inventory_status_report':
            fromDateInput.value = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 7).toISOString().split('T')[0];
            toDateInput.value = today.toISOString().split('T')[0];
            exportFormatSelect.value = 'csv';
            break;
        default:
            fromDateInput.value = lastMonth.toISOString().split('T')[0];
            toDateInput.value = today.toISOString().split('T')[0];
            exportFormatSelect.value = 'pdf';
    }
    
    // Scroll to form
    document.getElementById('generateReportForm').scrollIntoView({ behavior: 'smooth' });
}

function showLoadingModal() {
    document.getElementById('loadingModal').style.display = 'flex';
    document.getElementById('progressBar').style.width = '0%';
}

function hideLoadingModal() {
    document.getElementById('loadingModal').style.display = 'none';
}

function downloadReport(filename) {
    // In real implementation, this would trigger a download
    alert('Downloading: ' + filename);
    
    // Real implementation would be:
    /*
    window.location.href = '/reports/download/' + filename;
    */
}

function viewReport(filename) {
    // In real implementation, this would open the report in a new tab
    alert('Viewing: ' + filename);
    
    // Real implementation would be:
    /*
    window.open('/reports/view/' + filename, '_blank');
    */
}

// Set default dates on page load
document.addEventListener('DOMContentLoaded', function() {
    const today = new Date();
    const lastMonth = new Date(today.getFullYear(), today.getMonth() - 1, 1);
    const endOfLastMonth = new Date(today.getFullYear(), today.getMonth(), 0);
    
    document.getElementById('fromDate').value = lastMonth.toISOString().split('T')[0];
    document.getElementById('toDate').value = endOfLastMonth.toISOString().split('T')[0];
});

// Validate date range
document.getElementById('toDate').addEventListener('change', function() {
    const fromDate = document.getElementById('fromDate').value;
    const toDate = this.value;
    
    if (fromDate && toDate && new Date(fromDate) > new Date(toDate)) {
        alert('To date must be after from date');
        this.value = '';
    }
});

document.getElementById('fromDate').addEventListener('change', function() {
    const fromDate = this.value;
    const toDate = document.getElementById('toDate').value;
    
    if (fromDate && toDate && new Date(fromDate) > new Date(toDate)) {
        alert('From date must be before to date');
        document.getElementById('toDate').value = '';
    }
});
</script>
{% endblock %}